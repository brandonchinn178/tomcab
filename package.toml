cabal-version = "2.2"

name = "tomcab"
version = "0.1.0"

auto-import = ["defaults"]

[common.defaults]
    ghc-options = ["-Wall"]
    default-language = "Haskell2010"

[common.wrapper-exe]
    hs-source-dirs = ["exe"]
    other-modules = ["Wrapper"]

    [common.wrapper-exe.build-depends]
    base = ">= 4.14 && < 5"
    process = "< 2"
    tomcab = ""

    [[common.wrapper-exe.if]]
        condition = "!os(windows)"
        build-depends = { unix = "< 3" }

[[library]]
    hs-source-dirs = ["src"]
    exposed-modules = ["*"]

    [library.build-depends]
    base = ">= 4.14 && < 5"
    containers = "< 1"
    directory = ">= 1.2.5.0 && < 2"
    filepath = "< 2"
    text = ">= 1 && < 3"
    toml-reader = "< 1"
    unliftio = "< 1"

[[executable]]
    name = "tomcab"
    hs-source-dirs = ["exe"]
    main-is = "Main.hs"

    [executable.build-depends]
    base = ">= 4.14 && < 5"
    tomcab = ""

[[executable]]
    import = ["wrapper-exe"]
    name = "stack-tomcab"
    main-is = "Stack.hs"

[[executable]]
    import = ["wrapper-exe"]
    name = "cabal-tomcab"
    main-is = "Cabal.hs"

[[test-suite]]
    name = "tomcab-tests"
    hs-source-dirs = ["test"]
    main-is = "Main.hs"
    other-modules = ["*"]

    ghc-options = ["-F -pgmF=tasty-autocollect"]
    build-tool-depends = ["tasty-autocollect:tasty-autocollect"]

    build-depends = [
        "base",
        "tasty-autocollect",
        "tomcab",
    ]
